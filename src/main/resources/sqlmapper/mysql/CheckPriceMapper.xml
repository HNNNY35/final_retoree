<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="CheckPrice">


    <!-- call CheckPrice.selectFromCAR_INFO -->
    <select id="selectFromCAR_INFO" 
        parameterType="Map" resultType="Map">
        SELECT  CAR_ID, MUNUFACTURER, DETAILED_MODEL, MODEL_YEAR, DRIVEN_DIST, FUEL 
        FROM CAR_INFO;
    </select>

    <!-- call CheckPrice.selectFromCAR_INFOWithHyundaiForFirst -->
    <select id="selectFromCAR_INFOWithHyundaiForFirst" 
        parameterType="Map" resultType="Map">
        SELECT  CAR_ID, MUNUFACTURER, DETAILED_MODEL, PRICE, MODEL_YEAR, DRIVEN_DIST, FUEL 
        FROM CAR_INFO
        WHERE 1 = 1 
        AND MUNUFACTURER = "현대"
        AND MODEL = "캐스퍼"
        ORDER BY PRICE
        LIMIT 4
    </select>

    <!-- call CheckPrice.selectFromCAR_INFOWithHyundaiForFirstMinMax -->
    <select id="selectFromCAR_INFOWithHyundaiForFirstMinMax" 
        parameterType="Map" resultType="Map">
        SELECT  MAX(PRICE) AS MAX, MIN(PRICE) AS MIN
        FROM CAR_INFO
        WHERE 1 = 1 
        AND MUNUFACTURER = "현대"
        AND MODEL = "캐스퍼"
    </select>
    <!-- call CheckPrice.selectFromCAR_INFOWithHyundaiForFirstModelMunufacturer -->
    <select id="selectFromCAR_INFOWithHyundaiForFirstModelMunufacturer" 
        parameterType="Map" resultType="Map">
        SELECT  MUNUFACTURER, MODEL 
        FROM CAR_INFO
        WHERE 1 = 1 
        AND MUNUFACTURER = "현대"
        AND MODEL = "캐스퍼"
        LIMIT 1;
    </select>
    

    <!-- call CheckPrice.selectFromCAR_INFOWithMinMax -->
    <!-- 최소가격, 최대가격 -->
    <select id="selectFromCAR_INFOWithMinMax" 
        parameterType="Map" resultType="Map">
        SELECT MAX(PRICE) AS MAX, MIN(PRICE) AS MIN 
        FROM CAR_INFO
        WHERE 1 = 1
        <if test = 'manufacturer!="제조사"'>
            AND MUNUFACTURER = #{manufacturer}
        </if>
        <if test = 'model!="모델"'>
            AND MODEL = #{model}
        </if>
        <choose>
            <when test='modelYear!="연식"'>
                AND MODEL_YEAR = #{modelYear}
            </when>
            <when test='modelYear!="2015"'>
                <![CDATA[
                AND MODEL_YEAR <= #{modelYear}
                ]]>
            </when>
            <otherwise></otherwise>
        </choose>
        <if test = 'fuel!="연료"'>
            AND FUEL = #{fuel}
        </if>
        <!-- 등급, 세부등급은 데이터 기입방식 확인 후 구현 -->
        <!--<if test = 'grade!="등급"'>
            AND CARGRADE = #{grade}
        </if>
        <if test = 'detailedGrade!="세부등급 없음"'>
            AND DETAILED_CARGRADE = #{detailedGrade}
        </if>-->
        <if test = 'distanceDriven!="0"'>
            <![CDATA[
            AND DRIVEN_DIST < #{distanceDriven}
            ]]>
        </if>
    </select>

    <!-- call CheckPrice.selectFromCAR_INFOWithFilter -->
    <select id="selectFromCAR_INFOWithFilter" 
        parameterType="Map" resultType="Map">
        SELECT  CAR_ID, MUNUFACTURER, DETAILED_MODEL, MODEL_YEAR, DRIVEN_DIST, FUEL 
        FROM CAR_INFO
        WHERE 1 = 1
        <if test = 'manufacturer!="제조사"'>
            AND MUNUFACTURER = #{manufacturer}
        </if>
        <if test = 'model!="모델"'>
            AND MODEL = #{model}
        </if>
        <choose>
            <when test='modelYear!="연식"'>
                AND MODEL_YEAR = #{modelYear}
            </when>
            <when test='modelYear!="2015"'>
                <![CDATA[
                AND MODEL_YEAR <= #{modelYear}
                ]]>
            </when>
            <otherwise></otherwise>
        </choose>
        <if test = 'fuel!="연료"'>
            AND FUEL = #{fuel}
        </if>
        <!-- 등급, 세부등급은 데이터 기입방식 확인 후 구현 -->
        <!--<if test = 'grade!="등급"'>
            AND CARGRADE = #{grade}
        </if>
        <if test = 'detailedGrade!="세부등급 없음"'>
            AND DETAILED_CARGRADE = #{detailedGrade}
        </if>-->
        <if test = 'distanceDriven!="0"'>
            <![CDATA[
            AND DRIVEN_DIST < #{distanceDriven}
            ]]>
        </if> 
    </select>

    <!-- call CheckPrice.selectFromCAR_INFOWithFilterGetManufAndModel -->
    <select id="selectFromCAR_INFOWithFilterGetManufAndModel" 
        parameterType="Map" resultType="Map">
        SELECT  MUNUFACTURER, MODEL
        FROM CAR_INFO
        WHERE 1 = 1
        <if test = 'manufacturer!="제조사"'>
            AND MUNUFACTURER = #{manufacturer}
        </if>
        <if test = 'model!="모델"'>
            AND MODEL = #{model}
        </if>
        <choose>
            <when test='modelYear!="연식"'>
                AND MODEL_YEAR = #{modelYear}
            </when>
            <when test='modelYear!="2015"'>
                <![CDATA[
                AND MODEL_YEAR <= #{modelYear}
                ]]>
            </when>
            <otherwise></otherwise>
        </choose>
        <if test = 'fuel!="연료"'>
            AND FUEL = #{fuel}
        </if>
        <!-- 등급, 세부등급은 데이터 기입방식 확인 후 구현 -->
        <!--<if test = 'grade!="등급"'>
            AND CARGRADE = #{grade}
        </if>
        <if test = 'detailedGrade!="세부등급 없음"'>
            AND DETAILED_CARGRADE = #{detailedGrade}
        </if>-->
        <if test = 'distanceDriven!="0"'>
            <![CDATA[
            AND DRIVEN_DIST < #{distanceDriven}
            ]]>
        </if> 

        LIMIT 1
    </select>
</mapper>